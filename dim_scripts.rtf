{\rtf1 \ansi \ansicpg1252 \deff0 \stshfdbch2 \stshfloch0 \stshfhich0 \deflang1033 \deflangfe1033 {\fonttbl {\f0 \froman \fcharset0 \fprq2 {\*\panose 02020603050405020304}Times New Roman{\*\falt Times New Roman};}{\f2 \fnil \fcharset134 \fprq0 {\*\panose 02010600030101010101}SimSun{\*\falt SimSun};}{\f3 \fswiss \fcharset0 \fprq0 {\*\panose 020b0604020202020204}Arial{\*\falt Arial};}{\f4 \fdecor \fcharset0 \fprq0 {\*\panose 020f0502020204030204}Calibri{\*\falt Calibri};}{\f5 \froman \fcharset0 \fprq0 {\*\panose 020f0502020204030204}Calibri{\*\falt Calibri};}{\f6 \fmodern \fcharset0 \fprq0 {\*\panose 02070309020205020404}Courier New{\*\falt Courier New};}}{\colortbl ;\red0 \green0 \blue0 ;\red128 \green0 \blue0 ;\red255 \green0 \blue0 ;\red0 \green128 \blue0 ;\red128 \green128 \blue0 ;\red0 \green255 \blue0 ;\red255 \green255 \blue0 ;\red0 \green0 \blue128 ;\red128 \green0 \blue128 ;\red0 \green128 \blue128 ;\red128 \green128 \blue128 ;\red112 \green48 \blue160 ;\red0 \green77 \blue187 ;\red192 \green192 \blue192 ;\red155 \green0 \blue211 ;\red0 \green0 \blue255 ;\red255 \green0 \blue255 ;\red0 \green255 \blue255 ;\red255 \green255 \blue255 ;\red0 \green0 \blue0 ;}{\stylesheet {\qj \li0 \ri0 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \f0 \snext0 \spriority0 Normal;}{\*\cs10 \snext10 \sunhideused \spriority99 Default Paragraph Font;}}{\*\latentstyles \lsdstimax260 \lsdlockeddef0 \lsdsemihiddendef1 \lsdunhideuseddef1 \lsdqformatdef0 \lsdprioritydef99 {\lsdlockedexcept \lsdsemihidden0 \lsdunhideused0 \lsdpriority0 \lsdlocked0 Normal;\lsdpriority99 \lsdlocked0 heading 1;\lsdpriority99 \lsdlocked0 heading 2;\lsdpriority99 \lsdlocked0 heading 3;\lsdpriority99 \lsdlocked0 heading 4;\lsdpriority99 \lsdlocked0 heading 5;\lsdpriority99 \lsdlocked0 heading 6;\lsdpriority99 \lsdlocked0 heading 7;\lsdpriority99 \lsdlocked0 heading 8;\lsdpriority99 \lsdlocked0 heading 9;\lsdpriority99 \lsdlocked0 index 1;\lsdpriority99 \lsdlocked0 index 2;\lsdpriority99 \lsdlocked0 index 3;\lsdpriority99 \lsdlocked0 index 4;\lsdpriority99 \lsdlocked0 index 5;\lsdpriority99 \lsdlocked0 index 6;\lsdpriority99 \lsdlocked0 index 7;\lsdpriority99 \lsdlocked0 index 8;\lsdpriority99 \lsdlocked0 index 9;\lsdpriority99 \lsdlocked0 toc 1;\lsdpriority99 \lsdlocked0 toc 2;\lsdpriority99 \lsdlocked0 toc 3;\lsdpriority99 \lsdlocked0 toc 4;\lsdpriority99 \lsdlocked0 toc 5;\lsdpriority99 \lsdlocked0 toc 6;\lsdpriority99 \lsdlocked0 toc 7;\lsdpriority99 \lsdlocked0 toc 8;\lsdpriority99 \lsdlocked0 toc 9;\lsdpriority99 \lsdlocked0 Normal Indent;\lsdpriority99 \lsdlocked0 footnote text;\lsdpriority99 \lsdlocked0 annotation text;\lsdpriority99 \lsdlocked0 header;\lsdpriority99 \lsdlocked0 footer;\lsdpriority99 \lsdlocked0 index heading;\lsdpriority99 \lsdlocked0 caption;\lsdpriority99 \lsdlocked0 table of figures;\lsdpriority99 \lsdlocked0 envelope address;\lsdpriority99 \lsdlocked0 envelope return;\lsdpriority99 \lsdlocked0 footnote reference;\lsdpriority99 \lsdlocked0 annotation reference;\lsdpriority99 \lsdlocked0 line number;\lsdpriority99 \lsdlocked0 page number;\lsdpriority99 \lsdlocked0 endnote reference;\lsdpriority99 \lsdlocked0 endnote text;\lsdpriority99 \lsdlocked0 table of authorities;\lsdpriority99 \lsdlocked0 macro;\lsdpriority99 \lsdlocked0 toa heading;\lsdpriority99 \lsdlocked0 List;\lsdpriority99 \lsdlocked0 List Bullet;\lsdpriority99 \lsdlocked0 List Number;\lsdpriority99 \lsdlocked0 List 2;\lsdpriority99 \lsdlocked0 List 3;\lsdpriority99 \lsdlocked0 List 4;\lsdpriority99 \lsdlocked0 List 5;\lsdpriority99 \lsdlocked0 List Bullet 2;\lsdpriority99 \lsdlocked0 List Bullet 3;\lsdpriority99 \lsdlocked0 List Bullet 4;\lsdpriority99 \lsdlocked0 List Bullet 5;\lsdpriority99 \lsdlocked0 List Number 2;\lsdpriority99 \lsdlocked0 List Number 3;\lsdpriority99 \lsdlocked0 List Number 4;\lsdpriority99 \lsdlocked0 List Number 5;\lsdpriority99 \lsdlocked0 Title;\lsdpriority99 \lsdlocked0 Closing;\lsdpriority99 \lsdlocked0 Signature;\lsdpriority99 \lsdlocked0 Default Paragraph Font;\lsdpriority99 \lsdlocked0 Body Text;\lsdpriority99 \lsdlocked0 Body Text Indent;\lsdpriority99 \lsdlocked0 List Continue;\lsdpriority99 \lsdlocked0 List Continue 2;\lsdpriority99 \lsdlocked0 List Continue 3;\lsdpriority99 \lsdlocked0 List Continue 4;\lsdpriority99 \lsdlocked0 List Continue 5;\lsdpriority99 \lsdlocked0 Message Header;\lsdpriority99 \lsdlocked0 Subtitle;\lsdpriority99 \lsdlocked0 Salutation;\lsdpriority99 \lsdlocked0 Date;\lsdpriority99 \lsdlocked0 Body Text First Indent;\lsdpriority99 \lsdlocked0 Body Text First Indent 2;\lsdpriority99 \lsdlocked0 Note Heading;\lsdpriority99 \lsdlocked0 Body Text 2;\lsdpriority99 \lsdlocked0 Body Text 3;\lsdpriority99 \lsdlocked0 Body Text Indent 2;\lsdpriority99 \lsdlocked0 Body Text Indent 3;\lsdpriority99 \lsdlocked0 Block Text;\lsdpriority99 \lsdlocked0 Hyperlink;\lsdpriority99 \lsdlocked0 FollowedHyperlink;\lsdpriority99 \lsdlocked0 Strong;\lsdpriority99 \lsdlocked0 Emphasis;\lsdpriority99 \lsdlocked0 Document Map;\lsdpriority99 \lsdlocked0 Plain Text;\lsdpriority99 \lsdlocked0 E-mail Signature;\lsdpriority99 \lsdlocked0 Normal (Web);\lsdpriority99 \lsdlocked0 HTML Acronym;\lsdpriority99 \lsdlocked0 HTML Address;\lsdpriority99 \lsdlocked0 HTML Cite;\lsdpriority99 \lsdlocked0 HTML Code;\lsdpriority99 \lsdlocked0 HTML Definition;\lsdpriority99 \lsdlocked0 HTML Keyboard;\lsdpriority99 \lsdlocked0 HTML Preformatted;\lsdpriority99 \lsdlocked0 HTML Sample;\lsdpriority99 \lsdlocked0 HTML Typewriter;\lsdpriority99 \lsdlocked0 HTML Variable;\lsdpriority99 \lsdlocked0 Normal Table;\lsdpriority99 \lsdlocked0 annotation subject;\lsdpriority99 \lsdlocked0 No List;\lsdpriority99 \lsdlocked0 Table Simple 1;\lsdpriority99 \lsdlocked0 Table Simple 2;\lsdpriority99 \lsdlocked0 Table Simple 3;\lsdpriority99 \lsdlocked0 Table Classic 1;\lsdpriority99 \lsdlocked0 Table Classic 2;\lsdpriority99 \lsdlocked0 Table Classic 3;\lsdpriority99 \lsdlocked0 Table Classic 4;\lsdpriority99 \lsdlocked0 Table Colorful 1;\lsdpriority99 \lsdlocked0 Table Colorful 2;\lsdpriority99 \lsdlocked0 Table Colorful 3;\lsdpriority99 \lsdlocked0 Table Columns 1;\lsdpriority99 \lsdlocked0 Table Columns 2;\lsdpriority99 \lsdlocked0 Table Columns 3;\lsdpriority99 \lsdlocked0 Table Columns 4;\lsdpriority99 \lsdlocked0 Table Columns 5;\lsdpriority99 \lsdlocked0 Table Grid 1;\lsdpriority99 \lsdlocked0 Table Grid 2;\lsdpriority99 \lsdlocked0 Table Grid 3;\lsdpriority99 \lsdlocked0 Table Grid 4;\lsdpriority99 \lsdlocked0 Table Grid 5;\lsdpriority99 \lsdlocked0 Table Grid 6;\lsdpriority99 \lsdlocked0 Table Grid 7;\lsdpriority99 \lsdlocked0 Table Grid 8;\lsdpriority99 \lsdlocked0 Table List 1;\lsdpriority99 \lsdlocked0 Table List 2;\lsdpriority99 \lsdlocked0 Table List 3;\lsdpriority99 \lsdlocked0 Table List 4;\lsdpriority99 \lsdlocked0 Table List 5;\lsdpriority99 \lsdlocked0 Table List 6;\lsdpriority99 \lsdlocked0 Table List 7;\lsdpriority99 \lsdlocked0 Table List 8;\lsdpriority99 \lsdlocked0 Table 3D effects 1;\lsdpriority99 \lsdlocked0 Table 3D effects 2;\lsdpriority99 \lsdlocked0 Table 3D effects 3;\lsdpriority99 \lsdlocked0 Table Contemporary;\lsdpriority99 \lsdlocked0 Table Elegant;\lsdpriority99 \lsdlocked0 Table Professional;\lsdpriority99 \lsdlocked0 Table Subtle 1;\lsdpriority99 \lsdlocked0 Table Subtle 2;\lsdpriority99 \lsdlocked0 Table Web 1;\lsdpriority99 \lsdlocked0 Table Web 2;\lsdpriority99 \lsdlocked0 Table Web 3;\lsdpriority99 \lsdlocked0 Balloon Text;\lsdpriority99 \lsdlocked0 Table Grid;\lsdpriority99 \lsdlocked0 Table Theme;\lsdpriority99 \lsdlocked0 Light Shading;\lsdpriority99 \lsdlocked0 Light List;\lsdpriority99 \lsdlocked0 Light Grid;\lsdpriority99 \lsdlocked0 Medium Shading 1;\lsdpriority99 \lsdlocked0 Medium Shading 2;\lsdpriority99 \lsdlocked0 Medium List 1;\lsdpriority99 \lsdlocked0 Medium List 2;\lsdpriority99 \lsdlocked0 Medium Grid 1;\lsdpriority99 \lsdlocked0 Medium Grid 2;\lsdpriority99 \lsdlocked0 Medium Grid 3;\lsdpriority99 \lsdlocked0 Dark List;\lsdpriority99 \lsdlocked0 Colorful Shading;\lsdpriority99 \lsdlocked0 Colorful List;\lsdpriority99 \lsdlocked0 Colorful Grid;\lsdpriority99 \lsdlocked0 Light Shading Accent 1;\lsdpriority99 \lsdlocked0 Light List Accent 1;\lsdpriority99 \lsdlocked0 Light Grid Accent 1;\lsdpriority99 \lsdlocked0 Medium Shading 1 Accent 1;\lsdpriority99 \lsdlocked0 Medium Shading 2 Accent 1;\lsdpriority99 \lsdlocked0 Medium List 1 Accent 1;\lsdpriority99 \lsdlocked0 Medium List 2 Accent 1;\lsdpriority99 \lsdlocked0 Medium Grid 1 Accent 1;\lsdpriority99 \lsdlocked0 Medium Grid 2 Accent 1;\lsdpriority99 \lsdlocked0 Medium Grid 3 Accent 1;\lsdpriority99 \lsdlocked0 Dark List Accent 1;\lsdpriority99 \lsdlocked0 Colorful Shading Accent 1;\lsdpriority99 \lsdlocked0 Colorful List Accent 1;\lsdpriority99 \lsdlocked0 Colorful Grid Accent 1;\lsdpriority99 \lsdlocked0 Light Shading Accent 2;\lsdpriority99 \lsdlocked0 Light List Accent 2;\lsdpriority99 \lsdlocked0 Light Grid Accent 2;\lsdpriority99 \lsdlocked0 Medium Shading 1 Accent 2;\lsdpriority99 \lsdlocked0 Medium Shading 2 Accent 2;\lsdpriority99 \lsdlocked0 Medium List 1 Accent 2;\lsdpriority99 \lsdlocked0 Medium List 2 Accent 2;\lsdpriority99 \lsdlocked0 Medium Grid 1 Accent 2;\lsdpriority99 \lsdlocked0 Medium Grid 2 Accent 2;\lsdpriority99 \lsdlocked0 Medium Grid 3 Accent 2;\lsdpriority99 \lsdlocked0 Dark List Accent 2;\lsdpriority99 \lsdlocked0 Colorful Shading Accent 2;\lsdpriority99 \lsdlocked0 Colorful List Accent 2;\lsdpriority99 \lsdlocked0 Colorful Grid Accent 2;\lsdpriority99 \lsdlocked0 Light Shading Accent 3;\lsdpriority99 \lsdlocked0 Light List Accent 3;\lsdpriority99 \lsdlocked0 Light Grid Accent 3;\lsdpriority99 \lsdlocked0 Medium Shading 1 Accent 3;\lsdpriority99 \lsdlocked0 Medium Shading 2 Accent 3;\lsdpriority99 \lsdlocked0 Medium List 1 Accent 3;\lsdpriority99 \lsdlocked0 Medium List 2 Accent 3;\lsdpriority99 \lsdlocked0 Medium Grid 1 Accent 3;\lsdpriority99 \lsdlocked0 Medium Grid 2 Accent 3;\lsdpriority99 \lsdlocked0 Medium Grid 3 Accent 3;\lsdpriority99 \lsdlocked0 Dark List Accent 3;\lsdpriority99 \lsdlocked0 Colorful Shading Accent 3;\lsdpriority99 \lsdlocked0 Colorful List Accent 3;\lsdpriority99 \lsdlocked0 Colorful Grid Accent 3;\lsdpriority99 \lsdlocked0 Light Shading Accent 4;\lsdpriority99 \lsdlocked0 Light List Accent 4;\lsdpriority99 \lsdlocked0 Light Grid Accent 4;\lsdpriority99 \lsdlocked0 Medium Shading 1 Accent 4;\lsdpriority99 \lsdlocked0 Medium Shading 2 Accent 4;\lsdpriority99 \lsdlocked0 Medium List 1 Accent 4;\lsdpriority99 \lsdlocked0 Medium List 2 Accent 4;\lsdpriority99 \lsdlocked0 Medium Grid 1 Accent 4;\lsdpriority99 \lsdlocked0 Medium Grid 2 Accent 4;\lsdpriority99 \lsdlocked0 Medium Grid 3 Accent 4;\lsdpriority99 \lsdlocked0 Dark List Accent 4;\lsdpriority99 \lsdlocked0 Colorful Shading Accent 4;\lsdpriority99 \lsdlocked0 Colorful List Accent 4;\lsdpriority99 \lsdlocked0 Colorful Grid Accent 4;\lsdpriority99 \lsdlocked0 Light Shading Accent 5;\lsdpriority99 \lsdlocked0 Light List Accent 5;\lsdpriority99 \lsdlocked0 Light Grid Accent 5;\lsdpriority99 \lsdlocked0 Medium Shading 1 Accent 5;\lsdpriority99 \lsdlocked0 Medium Shading 2 Accent 5;\lsdpriority99 \lsdlocked0 Medium List 1 Accent 5;\lsdpriority99 \lsdlocked0 Medium List 2 Accent 5;\lsdpriority99 \lsdlocked0 Medium Grid 1 Accent 5;\lsdpriority99 \lsdlocked0 Medium Grid 2 Accent 5;\lsdpriority99 \lsdlocked0 Medium Grid 3 Accent 5;\lsdpriority99 \lsdlocked0 Dark List Accent 5;\lsdpriority99 \lsdlocked0 Colorful Shading Accent 5;\lsdpriority99 \lsdlocked0 Colorful List Accent 5;\lsdpriority99 \lsdlocked0 Colorful Grid Accent 5;\lsdpriority99 \lsdlocked0 Light Shading Accent 6;\lsdpriority99 \lsdlocked0 Light List Accent 6;\lsdpriority99 \lsdlocked0 Light Grid Accent 6;\lsdpriority99 \lsdlocked0 Medium Shading 1 Accent 6;\lsdpriority99 \lsdlocked0 Medium Shading 2 Accent 6;\lsdpriority99 \lsdlocked0 Medium List 1 Accent 6;\lsdpriority99 \lsdlocked0 Medium List 2 Accent 6;\lsdpriority99 \lsdlocked0 Medium Grid 1 Accent 6;\lsdpriority99 \lsdlocked0 Medium Grid 2 Accent 6;\lsdpriority99 \lsdlocked0 Medium Grid 3 Accent 6;\lsdpriority99 \lsdlocked0 Dark List Accent 6;\lsdpriority99 \lsdlocked0 Colorful Shading Accent 6;\lsdpriority99 \lsdlocked0 Colorful List Accent 6;\lsdpriority99 \lsdlocked0 Colorful Grid Accent 6;}}{\*\generator WPS Office}{\info {\author 3iindc0197}{\operator 3iindc0197}{\creatim \yr2019 \mo1 \dy18 \hr10 \min19 }{\revtim \yr2019 \mo1 \dy18 \hr20 \min7 }{\version1 }}\paperw12240 \paperh15840 \margl1800 \margr1800 \margt1440 \margb1440 \gutter0 \ftnbj \aenddoc \jcompress1 \viewkind4 \viewscale100 \asianbrkrule \allowfieldendsel \snaptogridincell \viewkind4 {\*\fchars !),.:;?]\'7d{\uc1 \u168 ?}{\uc1 \u183 ?}{\uc1 \u711 ?}{\uc1 \u713 ?}{\uc1 \u8213 ?}{\uc1 \u8214 ?}{\uc1 \u8217 ?}{\uc1 \u8221 ?}{\uc1 \u8230 ?}{\uc1 \u8758 ?}{\uc1 \u12289 ?}{\uc1 \u12290 ?}{\uc1 \u12291 ?}{\uc1 \u12293 ?}{\uc1 \u12297 ?}{\uc1 \u12299 ?}{\uc1 \u12301 ?}{\uc1 \u12303 ?}{\uc1 \u12305 ?}{\uc1 \u12309 ?}{\uc1 \u12311 ?}{\uc1 \u65281 ?}{\uc1 \u65282 ?}{\uc1 \u65287 ?}{\uc1 \u65289 ?}{\uc1 \u65292 ?}{\uc1 \u65294 ?}{\uc1 \u65306 ?}{\uc1 \u65307 ?}{\uc1 \u65311 ?}{\uc1 \u65341 ?}{\uc1 \u65344 ?}{\uc1 \u65372 ?}{\uc1 \u65373 ?}{\uc1 \u65374 ?}{\uc1 \u65504 ?}}{\*\lchars ([\'7b{\uc1 \u183 ?}{\uc1 \u8216 ?}{\uc1 \u8220 ?}{\uc1 \u12296 ?}{\uc1 \u12298 ?}{\uc1 \u12300 ?}{\uc1 \u12302 ?}{\uc1 \u12304 ?}{\uc1 \u12308 ?}{\uc1 \u12310 ?}{\uc1 \u65288 ?}{\uc1 \u65294 ?}{\uc1 \u65339 ?}{\uc1 \u65371 ?}{\uc1 \u65505 ?}{\uc1 \u65509 ?}}\fet2 {\*\ftnsep \pard \plain {\insrsid \chftnsep \par }}{\*\ftnsepc \pard \plain {\insrsid \chftnsepc \par }}{\*\aftnsep \pard \plain {\insrsid \chftnsep \par }}{\*\aftnsepc \pard \plain {\insrsid \chftnsepc \par }}\sectd \sbkpage \pgwsxn12240 \pghsxn15840 \marglsxn1800 \margrsxn1800 \margtsxn1440 \margbsxn1440 \guttersxn0 \headery720 \footery720 \pgbrdropt0 \sectdefaultcl \endnhere \pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //pigscript to read data from product table}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 producttable= load '/user/pnb_all_tables/configuration_tables/PRODUCT/part-m-00000' using PigStorage (',') AS (productid:int,productcode,description,makerid,makedate,status,authorid,authdate,companyid:int,cg_repayment_acnt_type:int,cg_od_acnt_type:int,cg_businesscenter:int,cg_assetfinanced:int,leadinquetime:int,cg_financepurposecode:int,cg_purchaseof:int,cg_existingasset:int,cg_islamicconcept:int,simul_foreclosure:int,penalty_no_of_day_month:int,preset_period:int,effective_date:int,product_limit:int,cg_disb_block:int,product_util_amt:int,cg_facility_risk_rate:int,prodsubtypecode,subtypedescription,superproduct,baseprdworkflow,producttype,legacycode2,facilitytypecode,characterflag,issecured,indvcorpflag,isfinanceforpurchase,isfinancedcollateralized,financeagainstexistingsasset,minmaxfinflag,issolicitorrequired,ismrtaallowed,teller_appr_yn,revolving_yn,progressive_disb_yn,legacycode3,penalty_int_day_month,floating_emi_tenor,effective_period,holiday_effect,legacycode1,description2,description3,subtypedescription2,subtypedescription3,tenortole:int,emicap:int,floater_lockin_period:int,is_project_finance,applicable_to);}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 descrip_subtypedescrip = foreach producttable generate description,subtypedescription,productcode;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 store descrip_subtypedescrip into '/user/pig_data/product' using PigStorage (',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //hive to create product table of req columns}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table product_temp (product string,subproduct string,productcode string)}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 row format delimited }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 hive.warehouse.subdir.inherit.perms=false //to solve 'user null does not belong to hadoop bug'}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 load data inpath '/user/pig_data/product/part-v000-o000-r-00000' into table product_temp;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //pig - Prd_scheme}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 prd_schtable = load '/user/pnb_all_tables/configuration_tables/PRD_SCHEME/part-m-00000' using PigStorage (',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 scheme_description = foreach prd_schtable generate $1, $117;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 store scheme_description into '/user/pig_data/prdscheme' using PigStorage (',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //hive--temp_table-prdscheme}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 Create table prdscheme_temp (sheme string,productcode string)}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 row format delimited }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 load data inpath '/user/pig_data/prdscheme/part-v000-o000-r-00000' into table prdscheme_temp;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 //To populate dim_product}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table dim_product (productid int,product string, subproduct string , scheme string)}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 row format delimited }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_product  select incr(), a.product,a.subproduct,b.sheme from (select distinct product,subproduct,productcode from product_temp) a join (select distinct(sheme),productcode from prdscheme_temp ) b on a.productcode=b.productcode;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //pig-- company-generic}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 company_generic = load '/user/pnb_all_tables/configuration_tables/COMPANY_GENERIC/part-m-00000' using PigStorage (',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 keyf = filter company_generic by $2=='RESIM';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 companygeneric_description = foreach keyf generate $9 ;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 dump companygeneric_description;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 store companygeneric_description into '/user/pig_data/companygeneric_description' using PigStorage (',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //hive--temp-table-company_generic}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table company_generic_description (description string)}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 row format delimited}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 load data inpath '/user/pig_data/companygeneric_description/part-v000-o000-r-00000' into table company_generic_description;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //pig - EMPLOYEE}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 emptableload = load '/user/pnb_all_tables/configuration_tables/EMPLOYEE/part-m-00000' using PigStorage(); }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 secusertbl = load '/user/pnb_all_tables/configuration_tables/SEC_USER/part-m-00000' using PigStorage ();}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 seccols = foreach secusertbl generate $1,$2,$21;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 //hive-Dim_Employee}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table dim_employee ( employeeid bigint, employeecode string, employeename string, empusername string,userid string,ssouserid string,employeestatus string) row format delimited fields terminated by ',' ;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert into dim_employee select incr() , a.employeecode,a.employeename,b.username,b.userid,b.sso_userid,a.status from (select distinct employeecode,employeename,status from testing.employee_temp) a join (select distinct username, userid,sso_userid from testing.secuser_temp) b on a.employeecode=b.userid;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //pig --BP}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 bptbl = load '/user/pnb_all_tables/configuration_tables/BP/part-m-00000' using PigStorage(',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 bpcols = foreach bptbl generate $1,$2,$3;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 store bpcols into '/user/pig_data/bp' using PigStorage (',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 //pig--BPTYPE}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 bptypetbl = load '/user/pnb_all_tables/configuration_tables/BPTYPE/part-m-00000' using PigStorage(',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 bptypecols = foreach bptype generate $1,$2;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 store bptypecols into '/user/pig_data/bptype' using PigStorage (',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //hive--bptype_temp}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  create table bptype_temp ( bptype string ,bpdescription string ) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 //Hive-- dim_business_partner}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table dim_business_partner (buss_part_id int, buss_part_type_code string,buss_part_type string ,buss_part_code string,buss_part_name string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table bp_temp (bptype string , bpcode string , bpname string ) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_business_partner select incr(),a.bptype,b.bpdescription,a.bp_code,a.bpname from (select distinct bptype,bp_code,bpname from bp_temp) a join (select distinct bptype,bpdescription from bptype ) b on a.bptype=b.bptype;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //pig-- }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 lmt_rcpt_tbl = load '/user/pnb_all_tables/loan_management_tables/LMT_RCPT/part-m-00000' using PigStorage (',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 lmtcols = foreach lmt_rcpt_tbl generate $0,$2,$16,$8,$26,$14,$15,$51,$52;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 store lmtcols into '/user/pig_data/lmt_rcpt' using PigStorage(',');}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table lmt_rcpt_temp (TRANRCPTID bigint,CG_PAYMENTMODE string,STATUS string, INSTRUMENTNUM string,CG_PAYMENT_LOCATION string,MAKERID string,MAKEDATE string, AUTHORID string,AUTHDATE string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 load data inpath '/user/pig_data/lmt_rcpt/part-v000-o000-r-00005' into table lmt_rcpt_temp;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 //hive --DIM_reciept}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table dim_receipt (receipt bigint, TRANRCPTID bigint,CG_PAYMENTMODE string,STATUS string, INSTRUMENTNUM string,CG_PAYMENT_LOCATION string,MAKERID string,MAKEDATE string, AUTHORID string,AUTHDATE string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_receipt select incr(), a.tranrcptid,a.cg_paymentmode,a.status,a.instrumentnum,a.cg_payment_location, a.makerid, a.makedate , a.authorid , a.authdate from (select distinct tranrcptid,cg_paymentmode,status,instrumentnum,cg_payment_location, makerid, makedate , authorid , authdate from testing.lmt_rcpt_temp) a ;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 //dim_branch}{\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table dim_branch (zoneid bigint , zone string , hub string , branch string , branchaddressid int , branch_type string ) row format delimited feilds terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_branch select incr() , a.description , a.description3,a.pkey,NULL, a.branch from ( select distinct id, description , description3,pkey, a.branch from testing.cg_demo_final1) a ;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 //dim_relogin_flag }{\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf15 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create  table dim_relogin_flag (reloginid bigint , relogin_flag string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_relogin_flag select incr() , a.relogin_flag from ( select distinct relogin_flag from testing.relogin_temp) a ;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf12 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang1033 \langnp1033 \cf12 //DIM_INSURANNCE_DTL}{\b1 \fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang1033 \langnp1033 \cf12 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table dim_insurace_dtl (isurance_id bigint, insurance_mode string, insurance_type string, insurance_partner string, insurance_tenure string, insurance_funded_by_customer string ) row format delimited fields terminated by ',' ;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table lot_insurance_temp (PREMIUM_FUNDED_BY string,CG_INSTYPE bigint, BPID bigint,TERM_IN_YEARS bigint,AMT_PAID_BY_CUST double ,PREMIUM_AMT double ) row format delimited fields terminated by ',' ;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 load path data inpath '/user/LOT_INSURANCE/part-m-00000' overwrite into table lot_insurance_temp;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table company_gen_temp (genericid int, description string) row format delimitede fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 load path data inpath '/user/COMPANY_GENERIC/part-m-00000' overwrite into table company_generic_temp;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table company_gen_temp2 (genericid int, description string) row format delimitede fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table company_gen_temp2 select * from company_gen_temp where genericid is not null;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 select cg.description, cf.description}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0   from lot_insurance_temp i, company_gen_temp2 cg, company_gen_temp2 cf}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  where i.premium_funded_by = cg.genericid}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0    and i.cg_instype = cf.genericid;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table insurance_temp_final  (insurance_mode string, insurance_type string , insurance_partner string,insurance_tenure int,insurance_funded_by_customer string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table insurance_temp_final select cg.description,}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        cf.description,}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        bpid,}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        i.term_in_years,}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        nvl(i.amt_paid_by_cust, i.premium_amt)}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0   from lot_insurance_temp i, company_gen_temp2 cg, company_gen_temp2 cf}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  where i.premium_funded_by = cg.genericid}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0    and i.cg_instype = cf.genericid;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_insurace_dtl select incr(),a.insurance_mode,a.insurance_type,a.insurance_partner,a.insurance_tenure,a.insurance_funded_by_customer from (select distinct insurance_mode , insurance_type  , insurance_partner ,insurance_tenure ,insurance_funded_by_customer from testing.insurance_temp_final) a}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 //dim_generic_mst}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table dim_generic_mst (id int , generic_id int , generic_key string , generic_value string , generic_desc string , generic_desc3 string ) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert into dim_generic_mst select incr() , a.genericid,a.key,a.value,a.description,a.description3 from (select genericid,key,value,description,description3 from testing.company_generic_2) a ;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 // dim_bussiness_partner}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_business_partner select incr(),a.bptype,b.bpdescription,a.bp_code,a.bpname from  (select distinct bptype,bp_code,bpname from testing.bp_temp2) a join (select distinct bptype,bpdescription from testing.bptype_temp ) b on a.bptype=b.bptype;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 //dim_sourcing}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 Logic }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 SELECT bt.bpdescription,}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        b.bpname,}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        b.bp_code,}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        e.employeename}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0   FROM lot_globalloan_temp lgt, bptype_temp bt, employee_temp e,bp_temp2 b}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  where lgt.src_bptype = bt.bptype}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  and lgt.SVC_BPTYPE = (b.bpid)}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0    and lgt.cg_staff_name = e.employeecode;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_sourcing select incr() ,a.bpdescription,a.bpname,a.bpcode,a.employeename from (select distinct bpdescription,bpname,bpcode,employeename from testing.sourcing_temp) a; }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table company_generic (GENERICID int,COMPANYID int,KEY string,VALUE string,MAKERID string,MAKEDATE date,STATUS string,AUTHORID string,AUTHDATE date,DESCRIPTION string,PARENTKEY int,REMARKS string,LEGACYCODE1 string,LEGACYCODE2 string,LEGACYCODE3 string,LEGACYCODE4 string,DESCRIPTION2 string,DESCRIPTION3 string,LEGACYCODE5 string,MODULEID string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 //dim_deviations}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 logic:}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 SELECT lmd.compapplid, }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        cg2.legacycode1, }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0        cg1.description }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0   FROM lot_manual_deviation_temp lmd, company_generic cg1, company_generic cg2 }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  where cg1.genericid = lmd.POLICY_DESC }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0    and cg2.key = 'HIRLEVEL' }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0    and cg2.value = lmd.cg_hirlevel; }{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table dim_deviations (deviation_id bigint,comp_appl_id int, hirelevel string ,deviation_policy string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_deviations select incr() , a.compapplid,a.hirlevel,a.deviationpolicy from (select distinct  compapplid,hirlevel,deviationpolicy from testing.deviations_temp) a;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 //Dim_stage}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0  create table dim_stage (stageid int,stagedesc string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 insert overwrite table dim_stage select distinct stageid,stagedesc from testing.stage_temp;}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf3 //temp tables of bank_master and bank_branch_master}{\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af4 \hich \af4 \loch \f4 \lang9 \langnp9 \cf0 create table bank_branch_mst_temp (}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 BBM_CD string,BBM_BANK_CD string ,BBM_DESC string ,MICRCODE string ,IFSC_CODE string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0  }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf15 //dim_bank_master }{\b1 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf15 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 create table dim_bank_master (bm_id bigint,bbm_id string,bank_name string,branch_name string,micrcode string,ifsc_code string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 Logic:}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 SELECT bb.bbm_bank_cd, b.bm_name, bb.bbm_desc, bb.micrcode, bb.ifsc_code }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0   FROM bank_branch_mst_temp bb, bank_mst_temp b }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0  where bb.bbm_cd = b.bm_cd; }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 create table bank_branch_master_temp( }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 BBM_CD string,BBM_BANK_CD string,BBM_DESC string,MICRCODE string ,IFSC_CODE string) row format delimited fields terminated by ',';}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf13 Logic:}{\b1 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf13 \par }\pard \plain \ql \li0 \ri0 \lisb0 \lisa0 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf10 \highlight19 SELECT}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  bb.BBM_SRNO, b.bm_name, bb.bbm_desc, bb.micrcode, bb.ifsc_code }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19 \par }\pard \plain \ql \li0 \ri0 \lisb0 \lisa0 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19   }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf10 \highlight19 FROM}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  bank_branch_master}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang16393 \langnp16393 \cf8 \highlight19 _temp}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  bb, bank_master}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang16393 \langnp16393 \cf8 \highlight19 _temp}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  b }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf10 \highlight19 where}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  bb.bbm_sr_no = b.bm_srno}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf10 \highlight19 \par }\pard \plain \ql \li0 \ri0 \lisb0 \lisa0 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 insert overwrite table dim_bank_master select incr(), }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19 bb.BBM_SRNO, b.bm_name, bb.bbm_desc, bb.micrcode, bb.ifsc_code }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19 \par }\pard \plain \ql \li0 \ri0 \lisb0 \lisa0 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19   }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf10 \highlight19 FROM}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang16393 \langnp16393 \cf8 \highlight19 testing.}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19 bank_branch_master}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang16393 \langnp16393 \cf8 \highlight19 _temp}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  bb, }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang16393 \langnp16393 \cf8 \highlight19 testing.}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19 bank_master}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang16393 \langnp16393 \cf8 \highlight19 _temp}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  b }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  }{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf10 \highlight19 where}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf8 \highlight19  bb.bbm_sr_no = b.bm_srno}{\fs20 \kerning0 \dbch \af5 \hich \af6 \loch \f6 \lang1033 \langnp1033 \cf10 \highlight19 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang1033 \langnp1033 \cf0 --LOT_ADDRESS_DTL}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang1033 \langnp1033 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 create table }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang1033 \langnp1033 \cf0 lot_address_temp ( ADDRESSID int,PLOTNO string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  FLAT string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  BUILDINGNO string, BUILDINGNAME string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  SOCIETYNAME string, LANDMARK string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  ROAD string, LOCALITY string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  CITY string, CG}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 _}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0 LOCATIONCODE int,CG_STATECODE int, CG_COUNTRYCODE int,CG_ZIPCODE int }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 ) row format delimited fields terminated by ','}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang1033 \langnp1033 \cf0  }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 ;}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 create table }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang1033 \langnp1033 \cf0 lot_address_temp}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 2}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang1033 \langnp1033 \cf0  ( ADDRESSID int,PLOTNO string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  FLAT string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  BUILDINGNO string, BUILDINGNAME string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  SOCIETYNAME string, LANDMARK string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  ROAD string, LOCALITY string}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 ,}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0  CITY string, CG}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \cf1 \caps0 _}{\i0 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \expnd0 \expndtw0 \chcbpat19 \lang1033 \langnp1033 \cf1 \caps0 LOCATIONCODE int,CG_STATECODE int, CG_COUNTRYCODE int,CG_ZIPCODE int }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 ) row format delimited fields terminated by ','}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang1033 \langnp1033 \cf0  }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 ;}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 insert overwrite table lot_address_temp2 select * from lot_address_temp where addressid is not null;}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning0 \dbch \af4 \hich \af4 \loch \f4 \lang1033 \langnp1033 \cf0 Logic:}{\b1 \fs22 \kerning0 \dbch \af4 \hich \af4 \loch \f4 \lang1033 \langnp1033 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b0 \fs22 \kerning0 \dbch \af4 \hich \af4 \loch \f4 \lang1033 \langnp1033 \cf0 Select }{\b0 \fs22 \kerning0 \dbch \af4 \hich \af4 \loch \f4 \lang16393 \langnp16393 \cf0 CONCAT_WS(\uc1 \u8216 ?, \uc1 \u8216 ?,PLOTNO,a.FLAT,BUILDINGNO) ,CONCAT_WS(\uc1 \u8216 ?,\uc1 \u8217 ?,BUILDINGNAME,SOCIETYNAME),CONCAT_WS(\uc1 \u8216 ?,\uc1 \u8217 ?,LANDMARK,ROAD),CONCAT_WS(\uc1 \u8216 ?,\uc1 \u8217 ?,LOCALITY,CITY),   from }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang9 \langnp9 \cf0 lot_address_temp}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 2 a;}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0  Select CONCAT_WS('|',PLOTNO,FLAT,BUILDINGNO) as lin1 from lot_address_temp2;}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 Select CONCAT_WS(\uc1 \u8216 ?|,PLOTNO,FLAT,BUILDINGNO)as lin1 }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 from lot_address_temp2 }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 LOGIC}{\b1 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 Select CONCAT_WS('|',PLOTNO,FLAT,BUILDINGNO)as line1 ,CONCAT_WS('|',BUILDINGNAME,SOCIETYNAME) as line2 ,CONCAT_WS('|',LANDMARK,ROAD) as line3,CONCAT_WS('|',LOCALITY,CITY) as line4,c1.description,c2.description,c3.description,c4.description  from lot_address_temp2 a, company_generic_2 c1,company_generic_2 c2,company_generic_2 c3,company_generic_2 c4 where CG_LOCATIONCODE =c1.genericid and c1.key ='CITY'and CG_STATECODE = c2.genericid and c2.key = 'STATE'and CG_COUNTRYCODE = c3.genericid and c3.key = 'COUNTRY' and CG_ZIPCODE = c4.genericid and c4.key = 'PINCODE';}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 Create table address_temp (line1 string,line2 string,line3 string,line4 string , city string, state string, country string , pincode int);}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 Insert into address_temp Select CONCAT_WS('|',PLOTNO,FLAT,BUILDINGNO)as line1 ,CONCAT_WS('|',BUILDINGNAME,SOCIETYNAME) as line2 ,CONCAT_WS('|',LANDMARK,ROAD) as line3,CONCAT_WS('|',LOCALITY,CITY) as line4,c1.description,c2.description,c3.description,c4.description  from lot_address_temp2 a, company_generic c1,company_generic c2,company_generic c3,company_generic c4 where CG_LOCATIONCODE =c1.genericid and c1.key ='CITY'and CG_STATECODE = c2.genericid and c2.key = 'STATE'and CG_COUNTRYCODE = c3.genericid and c3.key = 'COUNTRY' and CG_ZIPCODE = c4.genericid and c4.key = 'PINCODE';}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 Create table dim_address (address_id bigint,line1 string,line2 string,line3 string,line4 string , city string, state string, country string , postcode int) ;}{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 Insert overwrite table dim_address select incr(), a.line1,a.line2,a.line3,a.line4,a.city,a.state,a.country,a.pincode from (select distinct line1,line2,line3,line4,city,state,country,pincode from testing.address_temp) a;  }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\b1 \fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }\pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 Create table lot_document_temp3 (DOXTXNID double, EXEC_BY string, EXEC_INFAVOUROF string, IDNUMBER string, EXP_DATE_RCPT string, CPC_STATUS string, CPC_REMARKS string, CG_APPROVEDBY string, CG_RELEASEDTO string, REMARKS string, CPCSTATUSCHANGEDBY string, CG_DOCCLASSID double,CG_DOCID double,RECV_STATUS string) row format delimited fields terminated by \uc1 \u8216 ?,\uc1 \u8217 ?; }{\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \sect }\sectd \sbkpage \pgwsxn12240 \pghsxn15840 \marglsxn1800 \margrsxn1800 \margtsxn1440 \margbsxn1440 \guttersxn0 \headery720 \footery720 \pgbrdropt0 \sectdefaultcl \endnhere \pard \plain \ql \li0 \ri0 \lisb0 \sa200 \lisa0 \sl276 \slmult1 \widctlpar \aspalpha \aspnum \adjustright \lin0 \rin0 \itap0 \fs21 \kerning2 \dbch \af2 \hich \af0 \loch \af0 {\fs22 \kerning2 \dbch \af5 \hich \af5 \loch \f5 \lang16393 \langnp16393 \cf0 \par }}